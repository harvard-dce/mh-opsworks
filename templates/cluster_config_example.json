{
  "region": "us-east-1",
  "vpc": {
    "name": "FILL_ME_IN",
    "cidr_block": "FILL_ME_IN",
    "_cidr_block_comment": "10.1.1.0/24 gives you 10.1.1.0-255"
  },
  "stack": {
    "name": "FILL_ME_IN",
    "service_role": {
      "name": "mh-opsworks-cluster"
    },
    "chef": {
      "custom_json": {
        "matterhorn_repo_root": "/opt/matterhorn",
        "storage": {
          "export_root": "/var/matterhorn",
          "network": "10.1.1.0/24",
          "layer_shortname": "storage"
        }
      },
      "custom_cookbooks_source": {
        "type": "git",
        "url": "https://github.com/harvard-dce/mh-opsworks-recipes",
        "revision": "master"
      }
    },
    "layers": [
      {
        "name": "MySQL db",
        "shortname": "mysql-db",
        "enable_auto_healing": true,
        "install_updates_on_boot": true,
        "type": "db-master",
        "auto_assign_public_ips": true,
        "use_ebs_optimized_instances": true,
        "attributes": {
          "MysqlRootPasswordUbiquitous": "true"
        },
        "custom_recipes": {
          "setup": [
            "mh-opsworks-recipes::install-utils",
            "mh-opsworks-recipes::create-matterhorn-user",
            "mh-opsworks-recipes::clone-matterhorn",
            "mh-opsworks-recipes::create-database"
          ]
        },
        "volume_configurations": [
          {
            "mount_point": "/vol/mysql",
            "raid_level": 1,
            "number_of_disks": 2,
            "size": "10",
            "volume_type": "gp2"
          }
        ],
        "instances": {
          "number_of_instances": 1,
          "instance_type": "t2.micro",
          "root_device_type": "ebs"
        }
      },
      {
        "name": "Storage",
        "shortname": "storage",
        "type": "custom",
        "enable_auto_healing": false,
        "auto_assign_elastic_ips": false,
        "install_updates_on_boot": true,
        "auto_assign_public_ips": true,
        "use_ebs_optimized_instances": true,
        "custom_recipes": {
          "setup": [
            "mh-opsworks-recipes::install-utils",
            "mh-opsworks-recipes::create-matterhorn-user",
            "mh-opsworks-recipes::nfs-export"
          ]
        },
        "volume_configurations": [
          {
            "mount_point": "/var/matterhorn",
            "raid_level": 0,
            "number_of_disks": 2,
            "size": "20",
            "volume_type": "gp2"
          }
        ],
        "instances": {
          "number_of_instances": 1,
          "instance_type": "t2.micro",
          "root_device_type": "ebs"
        }
      },
      {
        "name": "All in one",
        "shortname": "all-in-one",
        "type": "custom",
        "enable_auto_healing": false,
        "auto_assign_elastic_ips": true,
        "install_updates_on_boot": true,
        "auto_assign_public_ips": true,
        "custom_recipes": {
          "setup": [
            "mh-opsworks-recipes::install-utils",
            "mh-opsworks-recipes::install-mh-base-packages",
            "mh-opsworks-recipes::create-matterhorn-user",
            "mh-opsworks-recipes::clone-matterhorn",
            "mh-opsworks-recipes::nfs-client"
          ]
        },
        "instances": {
          "number_of_instances": 2,
          "instance_type": "t2.micro",
          "root_device_type": "ebs"
        }
      }
    ],
    "app": {
      "shortname": "matterhorn",
      "name": "Matterhorn",
      "type": "other",
      "deployment": {
        "to_layers": ["All in one"],
        "custom_json": { }
      },
      "app_source": {
        "type": "git",
        "url": "git@github.com:/blahblah FILL_ME_IN",
        "revision": "FILL_ME_IN"
      }
    },
    "users": [
      {
        "user_name": "FILL_ME_IN",
        "level": "FILL_ME_IN: one of: deny show deploy manage iam_only",
        "allow_ssh": true,
        "allow_sudo": true,
        "ssh_public_key": "The public key for this user"
      }
    ]
  }
}
